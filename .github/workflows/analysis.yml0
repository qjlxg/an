name: åŸºé‡‘æŠ•èµ„åˆ†æä¸æŠ¥å‘Šç”Ÿæˆ

on:
  # æ‰‹åŠ¨è§¦å‘ï¼šå…è®¸æ‚¨éšæ—¶åœ¨ GitHub Actions é¡µé¢æ‰‹åŠ¨è¿è¡Œæ­¤å·¥ä½œæµ
  workflow_dispatch:
  # å®šæ—¶è§¦å‘ï¼šä¾‹å¦‚ï¼Œè®¾ç½®åœ¨æ¯å‘¨ä¸€ 01:00 UTC (åŒ—äº¬æ—¶é—´å‘¨ä¸€ä¸Šåˆ 9:00) è‡ªåŠ¨è¿è¡Œ
  schedule:
    - cron: '0 1 * * 1' 
  # ä¹Ÿå¯ä»¥åœ¨å‘ fund_data/ ç›®å½•æ¨é€æ–°æ•°æ®æ—¶è¿è¡Œ (å¯é€‰)
  push:
    paths:
      - 'fund_data/*.csv'
      - 'fund_analysis.py'

jobs:
  analyze_and_commit:
    runs-on: ubuntu-latest
    steps:
      - name: æ£€å‡ºä»£ç  (Checkout repository)
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 

      - name: è®¾ç½® Python ç¯å¢ƒ
        uses: actions/setup-python@v4
        with:
          python-version: '3.x'

      - name: å®‰è£…æ‰€éœ€ä¾èµ–
        run: |
          pip install pandas numpy

      - name: è¿è¡ŒåŸºé‡‘åˆ†æè„šæœ¬
        run: |
          python fund_analysis.py

      - name: è®¾ç½® Git æäº¤ç”¨æˆ·ä¿¡æ¯
        run: |
          git config user.name "GitHub Actions Bot"
          git config user.email "41898282+github-actions[bot]@users.noreply.github.com"
          
      - name: æäº¤ç”Ÿæˆçš„æŠ¥å‘Šæ–‡ä»¶
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
        
          file_pattern: '**'
          commit_message: 'ğŸ¤– è‡ªåŠ¨åˆ†æï¼šæ›´æ–°åŸºé‡‘æŠ•èµ„å»ºè®®æŠ¥å‘Š'
          commit_options: '--no-verify --allow-empty'
          force_push: true
